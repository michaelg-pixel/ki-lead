# üéì Videokurs-System - Vollst√§ndige Dokumentation

Ein komplettes System f√ºr Video-Kurse und PDF-Kurse mit Admin-Vorschau, Customer-Dashboard, Fortschritts-Tracking und Digistore24-Integration.

---

## üìã Inhaltsverzeichnis

1. [√úberblick](#√ºberblick)
2. [Installation](#installation)
3. [Funktionen](#funktionen)
4. [Admin-Bereich](#admin-bereich)
5. [Customer-Bereich](#customer-bereich)
6. [Datenbank-Struktur](#datenbank-struktur)
7. [Digistore24 Integration](#digistore24-integration)
8. [API-Endpoints](#api-endpoints)

---

## üéØ √úberblick

Das Videokurs-System erm√∂glicht:
- **Video-Kurse** mit Modulen und Lektionen (YouTube/Vimeo)
- **PDF-Kurse** als Download
- **Freebie-Kurse** (kostenlos f√ºr alle)
- **Premium-Kurse** (√ºber Digistore24 kaufbar)
- **Fortschritts-Tracking** pro Lektion
- **Admin-Vorschau** vor Ver√∂ffentlichung
- **Responsives Design** f√ºr alle Ger√§te

---

## üöÄ Installation

### 1. Datenbank einrichten

**Option A: Automatisches Setup (empfohlen)**
```
https://app.mehr-infos-jetzt.de/setup/setup-course-system.php
```

**Option B: Manuell √ºber phpMyAdmin**
```bash
# SQL-Datei importieren
setup/course-system-setup.sql
```

### 2. Konfiguration √ºberpr√ºfen

Stelle sicher, dass folgende Dateien korrekt konfiguriert sind:
- `config/database.php` - Datenbankverbindung
- `webhook/digistore24.php` - Webhook-URL

### 3. Ordner-Berechtigungen

```bash
chmod 755 uploads/mockups/
chmod 755 uploads/pdfs/
```

---

## ‚ú® Funktionen

### Video-Kurse
- ‚úÖ Unbegrenzte Module pro Kurs
- ‚úÖ Unbegrenzte Lektionen pro Modul
- ‚úÖ YouTube & Vimeo Integration
- ‚úÖ PDF-Anh√§nge pro Lektion
- ‚úÖ Fortschrittsbalken
- ‚úÖ "Als abgeschlossen markieren"

### PDF-Kurse
- ‚úÖ Direkte PDF-Anzeige
- ‚úÖ Download-Funktion
- ‚úÖ Mockup/Vorschaubild

### Zugriffskontrolle
- ‚úÖ Freebie-Kurse (kostenlos f√ºr alle)
- ‚úÖ Premium-Kurse (Digistore24)
- ‚úÖ Manueller Admin-Zugang
- ‚úÖ Automatische Freischaltung per Webhook

---

## üîß Admin-Bereich

### Kurse verwalten

**URL:** `https://app.mehr-infos-jetzt.de/admin/dashboard.php?page=templates`

#### Kurs erstellen:
1. Klicke auf **"+ Neuer Kurs"**
2. F√ºlle folgende Felder aus:
   - **Kurstitel** (Pflicht)
   - **Kurstyp**: Video oder PDF
   - **Zugang**: Kostenlos (Freebie) oder Premium
   - **Beschreibung**
   - **Mockup-URL** oder Upload
   - **Digistore24 Produkt-ID** (f√ºr Premium-Kurse)
3. Klicke auf **"Kurs erstellen"**

#### Kurs bearbeiten:
**URL:** `https://app.mehr-infos-jetzt.de/admin/dashboard.php?page=course-edit&id={COURSE_ID}`

1. Module hinzuf√ºgen:
   - Klicke auf **"+ Modul hinzuf√ºgen"**
   - Titel und Beschreibung eingeben
   
2. Lektionen hinzuf√ºgen:
   - Klicke bei einem Modul auf **"+ Lektion hinzuf√ºgen"**
   - Titel, Beschreibung eingeben
   - Video-URL (YouTube/Vimeo)
   - Optional: PDF-Anhang hochladen

3. Reihenfolge √§ndern:
   - Drag & Drop (falls implementiert)
   - Oder manuell Sort-Order setzen

#### Vorschau anzeigen:
**URL:** `https://app.mehr-infos-jetzt.de/admin/preview_course.php?id={COURSE_ID}`

- Zeigt exakt wie der Kurs f√ºr Kunden aussieht
- Banner oben: "Admin-Vorschau"
- Alle Module und Lektionen navigierbar
- Video-Player funktioniert
- Keine Fortschritte werden gespeichert

---

## üë• Customer-Bereich

### Kurs√ºbersicht

**URL:** `https://app.mehr-infos-jetzt.de/customer/dashboard.php?page=kurse`

Zeigt zwei Bereiche:

#### ‚úÖ Verf√ºgbare Kurse
- Alle Freebie-Kurse
- Alle gekauften Premium-Kurse
- Mit Fortschrittsbalken (0-100%)
- Button: **"Kurs starten"** oder **"Weiter lernen (X%)"**

#### üîí Weitere Premium-Kurse
- Noch nicht gekaufte Kurse
- Mit üîí Badge
- Button: **"Jetzt kaufen"** ‚Üí Link zu Digistore24
- Hover-Effekt: Schloss-Icon

### Kursansicht

**URL:** `https://app.mehr-infos-jetzt.de/customer/course-view.php?id={COURSE_ID}`

**Linke Sidebar:**
- Kurstitel
- Fortschrittsbalken (Gesamt)
- Module mit Lektionen
- ‚úÖ Abgeschlossene Lektionen
- ‚ñ∂Ô∏è Aktuelle Lektion
- ‚ö™ Noch nicht begonnen

**Hauptbereich:**
- Video-Player (16:9 responsive)
- Lektionstitel
- Beschreibung
- PDF-Download (falls vorhanden)
- Button: **"Als abgeschlossen markieren"**

---

## üíæ Datenbank-Struktur

### 1. `courses`
Haupttabelle f√ºr alle Kurse

| Feld | Typ | Beschreibung |
|------|-----|--------------|
| `id` | INT | Prim√§rschl√ºssel |
| `title` | VARCHAR(255) | Kurstitel |
| `description` | TEXT | Kursbeschreibung |
| `type` | ENUM | 'video' oder 'pdf' |
| `mockup_url` | VARCHAR(500) | URL zum Vorschaubild |
| `pdf_file` | VARCHAR(500) | URL zur PDF-Datei |
| `is_freebie` | BOOLEAN | Kostenlos? |
| `is_active` | BOOLEAN | Aktiv? |
| `digistore_product_id` | VARCHAR(100) | Produkt-ID f√ºr Webhook |

### 2. `course_modules`
Module innerhalb eines Kurses

| Feld | Typ | Beschreibung |
|------|-----|--------------|
| `id` | INT | Prim√§rschl√ºssel |
| `course_id` | INT | Fremdschl√ºssel ‚Üí courses |
| `title` | VARCHAR(255) | Modultitel |
| `sort_order` | INT | Reihenfolge |

### 3. `course_lessons`
Lektionen innerhalb eines Moduls

| Feld | Typ | Beschreibung |
|------|-----|--------------|
| `id` | INT | Prim√§rschl√ºssel |
| `module_id` | INT | Fremdschl√ºssel ‚Üí course_modules |
| `title` | VARCHAR(255) | Lektionstitel |
| `video_url` | VARCHAR(500) | YouTube/Vimeo URL |
| `pdf_attachment` | VARCHAR(500) | PDF-Anhang |
| `sort_order` | INT | Reihenfolge |

### 4. `course_access`
Zugriffskontrolle

| Feld | Typ | Beschreibung |
|------|-----|--------------|
| `id` | INT | Prim√§rschl√ºssel |
| `user_id` | INT | Fremdschl√ºssel ‚Üí users |
| `course_id` | INT | Fremdschl√ºssel ‚Üí courses |
| `access_source` | ENUM | 'freebie', 'purchase', 'admin', 'digistore24' |
| `granted_at` | TIMESTAMP | Zugang erteilt am |

### 5. `course_progress`
Fortschritt pro Lektion

| Feld | Typ | Beschreibung |
|------|-----|--------------|
| `id` | INT | Prim√§rschl√ºssel |
| `user_id` | INT | Fremdschl√ºssel ‚Üí users |
| `lesson_id` | INT | Fremdschl√ºssel ‚Üí course_lessons |
| `completed` | BOOLEAN | Abgeschlossen? |
| `completed_at` | TIMESTAMP | Abgeschlossen am |

---

## üõí Digistore24 Integration

### Webhook-URL
```
https://app.ki-leadsystem.com/webhook/digistore24.php
```

### Setup in Digistore24:
1. Gehe zu **Produkt-Einstellungen**
2. **IPN-URL** setzen auf obige Webhook-URL
3. **Produkt-ID** notieren
4. In Admin: Produkt-ID beim Kurs hinterlegen

### Automatischer Ablauf:
1. Kunde kauft Kurs √ºber Digistore24
2. Digistore24 sendet IPN an Webhook
3. Webhook erstellt Zugang in `course_access`
4. Kunde sieht Kurs sofort in "Meine Kurse"

### Webhook-Payload Beispiel:
```json
{
  "event": "payment",
  "product_id": "12345",
  "buyer_email": "kunde@example.com",
  "order_id": "DS24-ABC123"
}
```

---

## üîå API-Endpoints

### 1. Kurse erstellen
**POST** `/admin/api/courses/create.php`

```javascript
const formData = new FormData();
formData.append('title', 'Mein Kurs');
formData.append('type', 'video');
formData.append('is_freebie', true);

fetch('/admin/api/courses/create.php', {
  method: 'POST',
  body: formData
});
```

**Response:**
```json
{
  "success": true,
  "course_id": 123
}
```

### 2. Kurs aktualisieren
**POST** `/admin/api/courses/update.php`

### 3. Kurs l√∂schen
**POST** `/admin/api/courses/delete.php`

### 4. Modul erstellen
**POST** `/admin/api/courses/modules/create.php`

### 5. Lektion erstellen
**POST** `/admin/api/courses/lessons/create.php`

### 6. Fortschritt speichern
**POST** `/customer/api/mark-lesson-complete.php`

```javascript
fetch('/customer/api/mark-lesson-complete.php', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    lesson_id: 456,
    completed: true
  })
});
```

**Response:**
```json
{
  "success": true,
  "message": "Lektion als abgeschlossen markiert"
}
```

---

## üé® Design-System

### Farben
```css
--primary: #a855f7         /* Lila */
--primary-dark: #8b40d1    /* Dunkel-Lila */
--primary-light: #c084fc   /* Hell-Lila */
--success: #4ade80         /* Gr√ºn */
--error: #fb7185           /* Rot */
--bg-primary: #0a0a16      /* Dunkel */
--bg-secondary: #1a1532    /* Mittel */
--text-primary: #e5e7eb    /* Hell */
```

### Komponenten
- **Cards**: 16px Radius, Gradient Hintergrund
- **Buttons**: 10px Radius, Hover-Effekte
- **Progress Bar**: 8px H√∂he, Gradient Fill
- **Video Player**: 16:9 Aspect Ratio

---

## üì± Responsive Design

### Breakpoints:
- **Desktop**: > 1024px (3 Spalten Grid)
- **Tablet**: 768-1024px (2 Spalten Grid)
- **Mobile**: < 768px (1 Spalte)

### Mobile Optimierungen:
- Sidebar wird zu Full-Screen Overlay
- Video bleibt 16:9 responsive
- Touch-optimierte Buttons
- Reduzierte Abst√§nde

---

## üîí Sicherheit

### Zugriffskontrolle:
- ‚úÖ Session-basierte Authentifizierung
- ‚úÖ Rollen-Check (Admin/Customer)
- ‚úÖ SQL Injection Prevention (PDO Prepared Statements)
- ‚úÖ XSS Prevention (htmlspecialchars)
- ‚úÖ CSRF-Token (empfohlen)

### Best Practices:
```php
// ‚úÖ Richtig
$stmt = $pdo->prepare("SELECT * FROM courses WHERE id = ?");
$stmt->execute([$course_id]);

// ‚ùå Falsch
$pdo->query("SELECT * FROM courses WHERE id = $course_id");
```

---

## üêõ Troubleshooting

### Problem: Kurse werden nicht angezeigt
**L√∂sung:** 
- Pr√ºfe `is_active = 1` in Datenbank
- Pr√ºfe Zugriff in `course_access` Tabelle
- √úberpr√ºfe Session-Status

### Problem: Video l√§dt nicht
**L√∂sung:**
- YouTube URL Format: `https://www.youtube.com/watch?v=VIDEO_ID`
- Vimeo URL Format: `https://vimeo.com/VIDEO_ID`
- Pr√ºfe Embed-Berechtigung des Videos

### Problem: Fortschritt wird nicht gespeichert
**L√∂sung:**
- Pr√ºfe `course_progress` Tabelle existiert
- Session aktiv?
- Browser-Console auf JS-Fehler pr√ºfen

---

## üìä Beispiel-Workflow

### Kompletter Kurs-Setup (Video):

1. **Admin: Kurs erstellen**
   ```
   Titel: "KI Mastery f√ºr Anf√§nger"
   Typ: Video
   Kostenlos: Ja
   ```

2. **Admin: Module hinzuf√ºgen**
   ```
   Modul 1: "Einf√ºhrung" (3 Lektionen)
   Modul 2: "Fortgeschritten" (5 Lektionen)
   ```

3. **Admin: Lektionen hinzuf√ºgen**
   ```
   Lektion 1.1: "Was ist KI?"
   Video: https://youtube.com/watch?v=xyz
   PDF: ki-basics.pdf
   ```

4. **Admin: Vorschau testen**
   ```
   Klick auf "Vorschau" Button
   ‚Üí Alle Lektionen navigierbar
   ‚Üí Video spielt ab
   ```

5. **Customer: Kurs starten**
   ```
   Dashboard ‚Üí Meine Kurse
   ‚Üí "KI Mastery" anklicken
   ‚Üí Lektion 1.1 √∂ffnet sich
   ```

6. **Customer: Lektion abschlie√üen**
   ```
   Video anschauen
   ‚Üí "Als abgeschlossen markieren"
   ‚Üí Fortschritt 12.5% (1/8 Lektionen)
   ```

---

## üöÄ Performance-Tipps

1. **Video-Optimierung:**
   - Nutze YouTube/Vimeo statt Self-Hosting
   - Aktiviere Lazy-Loading

2. **Datenbank:**
   - Indizes auf h√§ufig abgefragte Spalten
   - Regelm√§√üiges Vacuum/Optimize

3. **Caching:**
   - Kurs-Daten cachen (Redis/Memcached)
   - Browser-Cache f√ºr statische Assets

---

## üìû Support

Bei Fragen oder Problemen:
- **Dokumentation:** Siehe diese README
- **GitHub Issues:** [Repository Issues](https://github.com/michaelg-pixel/ki-lead/issues)
- **E-Mail:** support@example.com

---

## üìù Changelog

### Version 1.0.0 (2025-11-01)
- ‚úÖ Initiales Release
- ‚úÖ Video-Kurse mit Modulen & Lektionen
- ‚úÖ PDF-Kurse
- ‚úÖ Admin-Vorschau
- ‚úÖ Customer-Dashboard
- ‚úÖ Fortschritts-Tracking
- ‚úÖ Digistore24 Integration

---

## üìÑ Lizenz

Proprietary - Alle Rechte vorbehalten

---

**Viel Erfolg mit deinem Videokurs-System! üéâ**